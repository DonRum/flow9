import material/material;

main() {
	println("--0--");
	v0 = [0, 1, 2, 3, 4];

	println(v0);
	println("sum = " + toString(sum(v0)));

	a = make(v0);

	b = fmap(a, \v -> { println("fmapi item: " + toString(v)); v; });
	b2 = fmapu(a, \v -> { println("fmapu item: " + toString(v)); Pair(v, [\ -> println("fmapu dispose: " + toString(v))]); });
	b3 = fmapi(a, \i, v -> { println("fmapi item " + toString(i) + " : " + toString(v)); v; });
	b4 = fmapiu(a, \ii, v ->
			Pair(
				v,
				[
					makeSubscribe(ii, \i -> println("fmapiu item " + toString(i) + " : " + toString(v)))(),
					\ -> println("fmapiu dispose: " + toString(v))
				]
			)
		);
	b5 = fsubmap(a, \vv -> fselect(make(vv), FLift(\v -> { println("fsubmap item: " + toString(v)); v; })));
	b6 = fsubmapi(a, \ii, v -> fselect(ii, FLift(\i -> { println("fsubmapi item " + toString(i) + " : " + toString(v)); v; })));
	b7 = ffold(a, 0, \acc, v -> { println("ffold item (acc = " + toString(acc) + ") : " + toString(v)); acc + v; });

	makeSubscribe(b, \v -> println("fmap result: " + toString(v)))();
	makeSubscribe(b2, \v -> println("fmapu result: " + toString(v)))();
	makeSubscribe(b3, \v -> println("fmapi result: " + toString(v)))();
	makeSubscribe(b4, \v -> println("fmapiu result: " + toString(v)))();
	makeSubscribe(b5, \v -> println("fsubmap result: " + toString(v)))();
	makeSubscribe(b6, \v -> println("fsubmapi result: " + toString(v)))();
	makeSubscribe(b7, \v -> println("ffold result: " + toString(v)))();

	println("--1--");
	v1 = [1, 2, 3, 4];

	println(v1);
	println("sum = " + toString(sum(v1)));

	next(a, [1, 2, 3, 4]);

	println("--2--");
	v2 = [0, 1, 4];

	println(v2);
	println("sum = " + toString(sum(v2)));

	next(a, v2);

	println("--3--");
	v3 = [0, 1, 2, 3, 4];

	println(v3);
	println("sum = " + toString(sum(v3)));

	next(a, v3);

	println("--4--");
	v4 = [];

	println(v4);
	println("sum = " + toString(sum(v4)));

	next(a, v4);
}