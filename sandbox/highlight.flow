import material/material2tropic;

getCode() -> string {
	"public static void main(String args[]) { 
		System.out.println(\"Goodbye, World\"); 
	}
	"
}

main() {
	eval = ref \s : string -> {""};
	mrender(
		makeMaterialManager([]), true,
		MLines([
			MTextButton("CLICK", \ -> {
				if (js) {
					(^eval)("postMessage('" + escapeHtml2(getCode()) + "')");
				} else {
					(^eval)("setCode('" + escapeHtml2(getCode()) + "')");
				}
				{}
			}, [], []),
			MRealHTML(
				"http://localhost/flow/sandbox/test.html",
				make(WidthHeight(600.0, 400.0)),
				[PageEvalJS(\evalJs : (string) -> string -> {
					eval := evalJs;
				})]
			)
		])
	)
}
