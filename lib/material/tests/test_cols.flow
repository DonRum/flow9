import material/material2tropic;

main() {
	xs = make([1, 2, 3, 4]);
	itemHeight = make(0.0);
	makeLine =
		\x -> {
			c = make(TEmpty());
			timer(1000, \ ->
				next(c,
					MText(i2s(x), [])
					|> MAlignTop
					|> (\f -> MAvailable(f, TFixed(0.0, 200.0))),
				)
			);
			timer(2000, \ ->
				next(c,
					MText(i2s(x), [])
					|> MAlignTop
					|> (\f -> MAvailable(f, TFixed(0.0, 100.0))),
				)
			);

			MMutable(c);
		};
	mrender(makeMaterialManager([]), true,
		MDynamicList(
			fselect(xs, FLift(\ys ->
				mapi(ys, \i, y -> {
					lineContent = makeLine(y);
					MCustomLine(
						if (i == 0) {
							MAttachHeight(lineContent, itemHeight);
						} else {
							lineContent;
						},
						[]
					)
				})
			)),
			[],
			[MItemsHeights(\i ->
				if (i == 0)
					fmax(itemHeight, const(1.0))
				else
					itemHeight
			)]
		)
	);
}